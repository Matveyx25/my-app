{"ast":null,"code":"import _regeneratorRuntime from\"/Users/matveystepanov/Documents/SamuraysWay/first-project/my-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/matveystepanov/Documents/SamuraysWay/first-project/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/Users/matveystepanov/Documents/SamuraysWay/first-project/my-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/matveystepanov/Documents/SamuraysWay/first-project/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{usersAPI}from\"../api/api\";import{updateObjectInArray}from\"../utils/objects-helpers\";var FOLLOW='lightgram/users/FOLLOW';var UNFOLLOW='lightgram/users/UNFOLLOW';var SET_USERS='lightgram/users/SET_USERS';var SET_CURRENT_PAGE='lightgram/users/SET_CURRENT_PAGE';var SET_TOTAL_USERS_COUNT='lightgram/users/SET_TOTAL_USERS_COUNT';var TOGGLE_IS_FETCHING='lightgram/users/TOGGLE_IS_FETCHING';var TOGGLE_IS_FOLLOWING_PROGRESS='lightgram/users/TOGGLE_IS_FOLLOWING_PROGRESS';var initialState={users:[],pageSize:5,totalUsersCount:0,currentPage:1,isFetching:false,followingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread({},state,{users:updateObjectInArray(state.users,action.userId,\"id\",{followed:true})});case UNFOLLOW:return _objectSpread({},state,{users:updateObjectInArray(state.users,action.userId,\"id\",{followed:false})});case SET_USERS:return _objectSpread({},state,{users:action.users});case SET_CURRENT_PAGE:return _objectSpread({},state,{currentPage:action.currentPage});case SET_TOTAL_USERS_COUNT:return _objectSpread({},state,{totalUsersCount:action.count});case TOGGLE_IS_FETCHING:return _objectSpread({},state,{isFetching:action.isFetching});case TOGGLE_IS_FOLLOWING_PROGRESS:return _objectSpread({},state,{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.userId]):state.followingInProgress.filter(function(id){return id!=action.userId;})});default:return state;}};// ACTION CREATOR\nexport var followSuccess=function followSuccess(userId){return{type:FOLLOW,userId:userId};};export var unfollowSuccess=function unfollowSuccess(userId){return{type:UNFOLLOW,userId:userId};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var setCurrentPage=function setCurrentPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var setUsersTotalCount=function setUsersTotalCount(totalUsersCount){return{type:SET_TOTAL_USERS_COUNT,count:totalUsersCount};};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var toggleFollowingProgress=function toggleFollowingProgress(isFetching,userId){return{type:TOGGLE_IS_FOLLOWING_PROGRESS,isFetching:isFetching,userId:userId};};// THUNK\nvar followUnfollow=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch,userId,apiMethod,actionCreator){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(toggleFollowingProgress(true,userId));_context.next=3;return apiMethod(userId);case 3:response=_context.sent;if(response.resultCode==0){dispatch(actionCreator(userId));}dispatch(toggleFollowingProgress(false,userId));case 6:case\"end\":return _context.stop();}}},_callee);}));return function followUnfollow(_x,_x2,_x3,_x4){return _ref.apply(this,arguments);};}();export var requestUsers=function requestUsers(page,pageSize){return(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(toggleIsFetching(true));dispatch(setCurrentPage(page));_context2.next=4;return usersAPI.getUsers(page,pageSize);case 4:data=_context2.sent;dispatch(toggleIsFetching(false));dispatch(setUsers(data.items));dispatch(setUsersTotalCount(data.totalCount));case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x5){return _ref2.apply(this,arguments);};}());};export var unfollow=function unfollow(userId){return(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:followUnfollow(dispatch,userId,usersAPI.getUnFollow.bind(usersAPI),unfollowSuccess);case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x6){return _ref3.apply(this,arguments);};}());};export var follow=function follow(userId){return(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:followUnfollow(dispatch,userId,usersAPI.getFollow.bind(usersAPI),followSuccess);case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x7){return _ref4.apply(this,arguments);};}());};export default usersReducer;","map":{"version":3,"sources":["/Users/matveystepanov/Documents/SamuraysWay/first-project/my-app/src/redux/users-reduser.js"],"names":["usersAPI","updateObjectInArray","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USERS_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLOWING_PROGRESS","initialState","users","pageSize","totalUsersCount","currentPage","isFetching","followingInProgress","usersReducer","state","action","type","userId","followed","count","filter","id","followSuccess","unfollowSuccess","setUsers","setCurrentPage","setUsersTotalCount","toggleIsFetching","toggleFollowingProgress","followUnfollow","dispatch","apiMethod","actionCreator","response","resultCode","requestUsers","page","getUsers","data","items","totalCount","unfollow","getUnFollow","bind","follow","getFollow"],"mappings":"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","sourcesContent":["import { usersAPI } from \"../api/api\"\nimport { updateObjectInArray } from \"../utils/objects-helpers\"\n\nconst FOLLOW = 'lightgram/users/FOLLOW'\nconst UNFOLLOW = 'lightgram/users/UNFOLLOW'\nconst SET_USERS = 'lightgram/users/SET_USERS'\nconst SET_CURRENT_PAGE = 'lightgram/users/SET_CURRENT_PAGE'\nconst SET_TOTAL_USERS_COUNT = 'lightgram/users/SET_TOTAL_USERS_COUNT'\nconst TOGGLE_IS_FETCHING = 'lightgram/users/TOGGLE_IS_FETCHING'\nconst TOGGLE_IS_FOLLOWING_PROGRESS = 'lightgram/users/TOGGLE_IS_FOLLOWING_PROGRESS'\n\nlet initialState = {\n    users: [],\n    pageSize: 5,\n    totalUsersCount: 0,\n    currentPage: 1,\n    isFetching: false,\n    followingInProgress: []\n}\n\nconst usersReducer = (state = initialState, action) => {\n\n    switch (action.type) {\n        case FOLLOW:\n            return {\n                ...state,\n                users: updateObjectInArray(state.users, action.userId , \"id\" , {followed: true})\n            }\n        case UNFOLLOW:\n            return {\n                ...state,\n                users: updateObjectInArray(state.users, action.userId , \"id\" , {followed: false})\n\n            }\n        case SET_USERS:\n            return { ...state, users: action.users }\n        case SET_CURRENT_PAGE:\n            return { ...state, currentPage: action.currentPage }\n        case SET_TOTAL_USERS_COUNT:\n            return { ...state, totalUsersCount: action.count }\n        case TOGGLE_IS_FETCHING:\n            return { ...state, isFetching: action.isFetching }\n        case TOGGLE_IS_FOLLOWING_PROGRESS:\n            return {\n                ...state,\n                followingInProgress: action.isFetching\n                    ? [...state.followingInProgress, action.userId]\n                    : state.followingInProgress.filter(id => id != action.userId)\n            }\n        default:\n            return state\n    }\n}\n\n// ACTION CREATOR\n\nexport const followSuccess = (userId) => ({ type: FOLLOW, userId })\nexport const unfollowSuccess = (userId) => ({ type: UNFOLLOW, userId })\nexport const setUsers = (users) => ({ type: SET_USERS, users })\nexport const setCurrentPage = (currentPage) => ({ type: SET_CURRENT_PAGE, currentPage })\nexport const setUsersTotalCount = (totalUsersCount) => ({ type: SET_TOTAL_USERS_COUNT, count: totalUsersCount })\nexport const toggleIsFetching = (isFetching) => ({ type: TOGGLE_IS_FETCHING, isFetching })\nexport const toggleFollowingProgress = (isFetching, userId) => ({ type: TOGGLE_IS_FOLLOWING_PROGRESS, isFetching, userId })\n\n// THUNK\n\nconst followUnfollow = async(dispatch , userId , apiMethod , actionCreator) => {\n    dispatch(toggleFollowingProgress(true, userId))\n        let response = await apiMethod(userId)\n        if (response.resultCode == 0) {\n            dispatch(actionCreator(userId))\n        }\n        dispatch(toggleFollowingProgress(false, userId))\n}\n\nexport const requestUsers = (page, pageSize) => {\n    return async (dispatch) => {\n        dispatch(toggleIsFetching(true))\n        dispatch(setCurrentPage(page))\n\n        let data = await usersAPI.getUsers(page, pageSize)\n        dispatch(toggleIsFetching(false))\n        dispatch(setUsers(data.items))\n        dispatch(setUsersTotalCount(data.totalCount))\n    }\n}\n\nexport const unfollow = (userId) => {\n    return async (dispatch) => {\n        followUnfollow(dispatch , userId , usersAPI.getUnFollow.bind(usersAPI) , unfollowSuccess)\n    }\n}\n\nexport const follow = (userId) => {\n    return async (dispatch) => {\n        followUnfollow(dispatch , userId , usersAPI.getFollow.bind(usersAPI) , followSuccess)\n    }\n}\n\nexport default usersReducer"]},"metadata":{},"sourceType":"module"}