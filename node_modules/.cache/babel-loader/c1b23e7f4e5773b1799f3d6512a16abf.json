{"ast":null,"code":"import _regeneratorRuntime from\"/Users/matveystepanov/Documents/SamuraysWay/first-project/my-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/matveystepanov/Documents/SamuraysWay/first-project/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/Users/matveystepanov/Documents/SamuraysWay/first-project/my-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/matveystepanov/Documents/SamuraysWay/first-project/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{usersAPI,profileAPI}from\"../api/api\";import{stopSubmit}from\"redux-form\";var ADD_POST='lightgram/profile/ADD-POST';var SET_USER_PROFILE='lightgram/profile/SET-USER-PROFILE';var SET_STATUS='lightgram/profile/SET-STATUS';var SAVE_PHOTO_SUCCESS='lightgram/profile/SAVE_PHOTO_SUCCESS';var initialState={postsData:[{id:1,message:'Hi',likequantity:23},{id:2,message:'Hello',likequantity:23},{id:3,message:'you',likequantity:23},{id:3,message:'Yo',likequantity:23},{id:5,message:'Good bay',likequantity:23},{id:6,message:'Lose',likequantity:23}],profile:null,status:\"\"};var profileReducer=function profileReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case ADD_POST:{var newPost={id:8,message:action.newPostText,likequantity:0};var stateCopy=_objectSpread({},state);stateCopy.postsData=_toConsumableArray(state.postsData);stateCopy.postsData.unshift(newPost);return stateCopy;}case SET_USER_PROFILE:return _objectSpread({},state,{profile:action.profile});case SAVE_PHOTO_SUCCESS:debugger;return _objectSpread({},state,{profile:_objectSpread({},state.profile,{photo:action.photos})});case SET_STATUS:return _objectSpread({},state,{status:action.status});default:return state;}};export var addPostActionCreater=function addPostActionCreater(newPostText){return{type:ADD_POST,newPostText:newPostText};};export var setUserProfile=function setUserProfile(profile){return{type:SET_USER_PROFILE,profile:profile};};export var setStatus=function setStatus(status){return{type:SET_STATUS,status:status};};export var savePhotoSuccess=function savePhotoSuccess(photos){return{type:SAVE_PHOTO_SUCCESS,photos:photos};};export var getUserProfile=function getUserProfile(userId){return(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return usersAPI.getProfile(userId);case 2:response=_context.sent;dispatch(setUserProfile(response.data));case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());};export var getStatus=function getStatus(userId){return(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return profileAPI.getStatus(userId);case 2:response=_context2.sent;dispatch(setStatus(response.data));case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}());};export var updateStatus=function updateStatus(status){return(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return profileAPI.updateStatus(status);case 2:response=_context3.sent;if(response.data.resultCode===0){dispatch(setStatus(status));}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}());};export var savePhoto=function savePhoto(file){return(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return profileAPI.savePhoto(file);case 2:response=_context4.sent;if(response.data.resultCode===0){dispatch(savePhotoSuccess(response.data.data.photos));}case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}());};export var saveProfile=function saveProfile(profile){return(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch,getState){var userId,response;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:userId=getState().auth.userId;_context5.next=3;return profileAPI.saveProfile(profile);case 3:response=_context5.sent;if(!(response.data.resultCode===0)){_context5.next=8;break;}dispatch(getUserProfile(userId));_context5.next=10;break;case 8:dispatch(stopSubmit(\"edit-profile\",{_error:response.data.messages[0]}));return _context5.abrupt(\"return\",Promise.reject(response.data.messages[0]));case 10:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x5,_x6){return _ref5.apply(this,arguments);};}());};export default profileReducer;","map":{"version":3,"sources":["/Users/matveystepanov/Documents/SamuraysWay/first-project/my-app/src/redux/profile-reducer.js"],"names":["usersAPI","profileAPI","stopSubmit","ADD_POST","SET_USER_PROFILE","SET_STATUS","SAVE_PHOTO_SUCCESS","initialState","postsData","id","message","likequantity","profile","status","profileReducer","state","action","type","newPost","newPostText","stateCopy","unshift","photo","photos","addPostActionCreater","setUserProfile","setStatus","savePhotoSuccess","getUserProfile","userId","dispatch","getProfile","response","data","getStatus","updateStatus","resultCode","savePhoto","file","saveProfile","getState","auth","_error","messages","Promise","reject"],"mappings":"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","sourcesContent":["import { usersAPI, profileAPI } from \"../api/api\"\nimport { stopSubmit } from \"redux-form\"\n\nconst ADD_POST = 'lightgram/profile/ADD-POST'\nconst SET_USER_PROFILE = 'lightgram/profile/SET-USER-PROFILE'\nconst SET_STATUS = 'lightgram/profile/SET-STATUS'\nconst SAVE_PHOTO_SUCCESS = 'lightgram/profile/SAVE_PHOTO_SUCCESS'\n\nlet initialState = {\n    postsData: [\n        { id: 1, message: 'Hi', likequantity: 23 },\n        { id: 2, message: 'Hello', likequantity: 23 },\n        { id: 3, message: 'you', likequantity: 23 },\n        { id: 3, message: 'Yo', likequantity: 23 },\n        { id: 5, message: 'Good bay', likequantity: 23 },\n        { id: 6, message: 'Lose', likequantity: 23 }\n    ],\n    profile: null,\n    status: \"\",\n}\n\nconst profileReducer = (state = initialState, action) => {\n\n    switch (action.type) {\n        case ADD_POST:{\n            let newPost = {\n                id: 8,\n                message: action.newPostText,\n                likequantity: 0\n            }\n            let stateCopy = {...state}\n            stateCopy.postsData = [...state.postsData]\n            stateCopy.postsData.unshift(newPost)\n            return stateCopy\n        }\n        case SET_USER_PROFILE: \n            return {...state, profile: action.profile}\n        case SAVE_PHOTO_SUCCESS:\n            debugger\n            return {...state, profile: {...state.profile , photo: action.photos}}\n        case SET_STATUS: \n            return {...state, status: action.status}\n        default:\n            return state\n    }\n}\n\nexport const addPostActionCreater = (newPostText) => ({type: ADD_POST , newPostText})\nexport const setUserProfile = (profile) => ({type: SET_USER_PROFILE, profile})\nexport const setStatus = (status) => ({type: SET_STATUS, status})\nexport const savePhotoSuccess = (photos) => ({type: SAVE_PHOTO_SUCCESS, photos})\n\nexport const getUserProfile = (userId) => async (dispatch) => {\n    let response = await usersAPI.getProfile(userId)\n        dispatch(setUserProfile(response.data))\n}\nexport const getStatus = (userId) => async (dispatch) => {\n    let response = await profileAPI.getStatus(userId)\n                dispatch(setStatus(response.data))\n}\nexport const updateStatus = (status) => async (dispatch) => {\n    let response = await profileAPI.updateStatus(status)\n        if(response.data.resultCode === 0) {\n            dispatch(setStatus(status))\n    }\n}\nexport const savePhoto = (file) => async (dispatch) => {\n    let response = await profileAPI.savePhoto(file)\n        if(response.data.resultCode === 0) {\n            dispatch(savePhotoSuccess(response.data.data.photos))\n        }\n}\nexport const saveProfile = (profile) => async (dispatch , getState) => {\n    const userId = getState().auth.userId\n    const response = await profileAPI.saveProfile(profile)\n        if(response.data.resultCode === 0) {\n           dispatch(getUserProfile(userId))\n        }else{\n            dispatch(stopSubmit(\"edit-profile\" , { _error: response.data.messages[0]}))\n            return Promise.reject(response.data.messages[0])\n        }\n}\n\nexport default profileReducer"]},"metadata":{},"sourceType":"module"}